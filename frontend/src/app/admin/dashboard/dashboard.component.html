<div class="admin-dashboard">
  <h1>Admin Dashboard</h1>

  <div class="cards">
    <div class="card">
      <div class="title">Tổng xe</div>
      <div class="value">{{ stats.total_cars }}</div>
    </div>

    <div class="card">
      <div class="title">Tổng đơn</div>
      <div class="value">{{ stats.total_bookings }}</div>
    </div>

    <div class="card">
      <div class="title">Doanh thu</div>
      <div class="value">{{ formatMoney(stats.revenue) }} ₫</div>
    </div>

    <div class="card">
      <div class="title">Pending</div>
      <div class="value">{{ statusCount('pending') }}</div>
    </div>
  </div>

  <section class="chart-area">
    <h3>Booking theo trạng thái</h3>
    <div class="bar-list">
      <div class="bar-row" *ngFor="let s of ['pending','confirmed','rejected','canceled','completed']">
        <div class="label">{{ s | titlecase }}</div>
        <div class="bar">
          <div class="bar-fill" [style.width.%]="(statusCount(s) / (stats.total_bookings || 1)) * 100"></div>
        </div>
        <div class="count">{{ statusCount(s) }}</div>
      </div>
    </div>
  </section>

  <section class="recent">
    <h3>Booking gần nhất</h3>
    <div class="recent-list">
      <div class="recent-item" *ngFor="let b of stats.recent_bookings">
        <div class="left">
          <div class="name">{{ b.user?.name ?? 'Khách lạ' }}</div>
          <div class="car">{{ b.car?.name ?? '—' }}</div>
        </div>
        <div class="right">
          <div class="date">{{ b.start_date }} ➜ {{ b.end_date }}</div>
          <div class="price">{{ formatMoney(b.total_price) }} ₫</div>
        </div>
      </div>
    </div>
  </section>

  <section class="revenue-chart">
    <h3>Doanh thu tháng này</h3>
    <div class="chart">
      <div class="bar" *ngFor="let r of revenueMonth">
        <div class="bar-fill" [style.height.%]="(r.revenue / maxRevenueMonth) * 100"></div>
        <div class="label">{{ r.day }}</div>
      </div>
    </div>
  </section>

  <section class="top-cars">
    <h3>Top xe được thuê nhiều nhất</h3>
    <div class="list">
      <div class="item" *ngFor="let car of topCars">
        <div class="name">{{ car.name }}</div>
        <div class="count">{{ car.total_rentals }} lần</div>
      </div>
    </div>
  </section>

  <section class="new-bookings">
    <h3>Booking mới hôm nay</h3>
    <div class="list">
      <div class="item" *ngFor="let b of newBookings">
        <div class="user">{{ b.user?.name }}</div>
        <div class="car">{{ b.car?.name }}</div>
        <div class="price">{{ formatMoney(b.total_price) }} ₫</div>
      </div>
    </div>
  </section>

  <div class="actions">
    <a class="btn" routerLink="/admin/bookings">Quản lý booking</a>
    <a class="btn secondary" routerLink="/admin/cars">Quản lý xe</a>
  </div>
</div>
